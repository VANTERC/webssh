(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-009baa4a"],{"45fc":function(e,t,a){"use strict";var s=a("23e7"),r=a("b727").some,o=a("a640"),i=a("ae40"),n=o("some"),c=i("some");s({target:"Array",proto:!0,forced:!n||!c},{some:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},e2be:function(e,t,a){"use strict";a.r(t);var s=(a("d81d"),a("45fc"),{data:function(){return{modalTitle:"新增主机",isEdit:!1,hostForm:{hostName:"",hostIP:""},form:this.$form.createForm(this,{name:"createForm"}),createForm:{merchants:"",hostName:"",rootName:"",ip:"",port:"",configure:"",remarks:""},host_password:"",updateRowId:"",tableData:[],addVisible:!1,passwordVisible:!1,addconfirmLoading:!1,sshVerifyLoading:!1,tableLoading:!1,merchantsList:[{name:"阿里云",code:"m_001"},{name:"腾讯云",code:"m_002"},{name:"百度云",code:"m_003"},{name:"华为云",code:"m_004"},{name:"网易云",code:"m_005"},{name:"其他",code:"m_006"}],selectHostObj:{}}},created:function(){this.searchList()},methods:{linkhost:function(e){this.host_password="",this.selectHostObj=e,this.passwordVisible=!0},updateHost:function(){var e=this,t={id:this.updateRowId,merchants:this.createForm.merchants,hostName:this.createForm.hostName,rootName:this.createForm.rootName,ip:this.createForm.ip,port:this.createForm.port,configure:this.createForm.configure,remarks:this.createForm.remarks,password:this.createForm.password};this.$api.servers.updateHost(t).then((function(){e.$message.success("编辑成功"),e.addVisible=!1,e.addconfirmLoading=!1,e.searchList(),e.form.resetFields(),e.createForm.password="",e.passwordVisible=!1})).catch((function(){e.addconfirmLoading=!1}))},editHost:function(e){var t=this;this.modalTitle="编辑主机",this.isEdit=!0,this.addVisible=!0,this.updateRowId=e.id,this.createForm.merchants=e.merchants,this.createForm.hostName=e.hostName,this.createForm.rootName=e.rootName,this.createForm.ip=e.hostIp,this.createForm.port=e.port,this.createForm.configure=e.configure,this.createForm.remarks=e.remarks,this.$nextTick((function(){t.form.setFieldsValue({merchants:e.merchants,hostName:e.hostName,rootName:e.rootName,ip:e.hostIp,port:e.port,configure:e.configure,remarks:e.remarks})}))},deleteHost:function(e){var t=this;this.$confirm({title:"确定要删除该主机吗?",okText:"确认",cancelText:"取消",onOk:function(){var a={id:e};t.$api.servers.deleteHost(a).then((function(){t.$message.success("删除成功！"),t.searchList()}))},onCancel:function(){}})},searchList:function(){var e=this;this.tableLoading=!0,this.$api.servers.getHostList(this.hostForm).then((function(t){e.tableData=t.data,e.tableLoading=!1}))},verifyHost:function(){var e=this,t=this,a={sshObj:{host:this.selectHostObj.hostIp,port:this.selectHostObj.port,username:this.selectHostObj.rootName,password:this.host_password}};this.$api.servers.SSHVerify(a).then((function(a){if(a.data){var s=sessionStorage.HOSTDATA?JSON.parse(sessionStorage.HOSTDATA):[],r={hostId:e.selectHostObj.id,host:e.selectHostObj.hostIp,username:e.selectHostObj.rootName,password:e.host_password};s.length>0&&s.some((function(t){return t.host===e.selectHostObj.hostIp}))?s.map((function(t){t.host===e.selectHostObj.hostIp&&(t=r)})):s.push(r),sessionStorage.setItem("HOSTDATA",JSON.stringify(s)),e.$message.success("验证成功！"),e.sshVerifyLoading=!1,e.passwordVisible=!1,setTimeout((function(){var e=t.$router.resolve({path:"/webssh/".concat(t.selectHostObj.id)});window.open(e.href,"_blank")}),1e3)}else e.$message.warning("验证失败，请确认密码是否正确！"),e.sshVerifyLoading=!1})).catch((function(){e.sshVerifyLoading=!1}))},addHost:function(){this.modalTitle="新增主机",this.addVisible=!0,this.isEdit=!1},addhandleOk:function(){var e=this;this.form.validateFields((function(t,a){t?e.addconfirmLoading=!1:(e.createForm.merchants=a.merchants,e.createForm.hostName=a.hostName,e.createForm.rootName=a.rootName,e.createForm.ip=a.ip,e.createForm.port=a.port,e.createForm.configure=a.configure?a.configure:"",e.createForm.remarks=a.remarks?a.remarks:"",e.addconfirmLoading=!0,e.isEdit?e.updateHost():e.$api.servers.createHost(e.createForm).then((function(){e.addVisible=!1,e.addconfirmLoading=!1,e.searchList(),e.form.resetFields()})).catch((function(){e.addconfirmLoading=!1})))}))},pdwVisibleCancel:function(){this.passwordVisible=!1},addhandleCancel:function(){this.addVisible=!1,this.form.resetFields(),this.createForm.password=""},pwdVisibleHandleOk:function(){this.host_password?(this.sshVerifyLoading=!0,this.verifyHost()):this.$message.warning("请输入登录密码！")}}}),r=a("2877"),o=Object(r.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-card",[a("a-form",{attrs:{"label-col":{span:5},"wrapper-col":{span:12}}},[a("a-row",[a("a-col",{attrs:{span:8}},[a("a-form-item",{attrs:{label:"主机名称"}},[a("a-input",{model:{value:e.hostForm.hostName,callback:function(t){e.$set(e.hostForm,"hostName",t)},expression:"hostForm.hostName"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-item",{attrs:{label:"连接IP"}},[a("a-input",{model:{value:e.hostForm.hostIP,callback:function(t){e.$set(e.hostForm,"hostIP",t)},expression:"hostForm.hostIP"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-button",{attrs:{type:"primary"},on:{click:e.searchList}},[e._v("搜索")])],1)],1),a("a-row",[a("a-col",{attrs:{span:8}},[a("a-button",{attrs:{type:"primary"},on:{click:e.addHost}},[e._v("新增")])],1)],1)],1),a("a-table",{staticStyle:{"margin-top":"20px"},attrs:{"data-source":e.tableData,rowKey:"id",loading:e.tableLoading}},[a("a-table-column",{key:"merchants",attrs:{title:"主机供应商","data-index":"merchants"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.merchantsList.filter((function(e){return e.code===t}))[0].name))])]}}])}),a("a-table-column",{key:"hostName",attrs:{title:"主机名称","data-index":"hostName"}}),a("a-table-column",{key:"hostIp",attrs:{title:"连接IP","data-index":"hostIp"}}),a("a-table-column",{key:"port",attrs:{title:"端口","data-index":"port"}}),a("a-table-column",{key:"configure",attrs:{title:"配置","data-index":"configure"}}),a("a-table-column",{key:"remarks",attrs:{title:"备注","data-index":"remarks"}}),a("a-table-column",{key:"options",attrs:{title:"操作","data-index":"options"},scopedSlots:e._u([{key:"default",fn:function(t,s){return[a("a",{on:{click:function(t){return e.editHost(s)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"red"},on:{click:function(t){return e.deleteHost(s.id)}}},[e._v("删除")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.linkhost(s)}}},[e._v("console")])]}}])})],1)],1),a("a-modal",{attrs:{width:800,title:e.modalTitle,visible:e.addVisible,"confirm-loading":e.addconfirmLoading,okText:"确定",cancelText:"取消"},on:{ok:e.addhandleOk,cancel:e.addhandleCancel}},[a("a-form",{attrs:{form:e.form,"label-col":{span:4},"wrapper-col":{span:16}}},[a("a-form-item",{attrs:{label:"主机供应商"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["merchants",{rules:[{required:!0,message:"请选择供应商！"}]}],expression:"['merchants', { rules: [{ required: true, message: '请选择供应商！' }] }]"}],staticStyle:{width:"200px"},attrs:{placeholder:"请选择供应商"}},e._l(e.merchantsList,(function(t){return a("a-select-option",{key:t.code,attrs:{value:t.code}},[e._v(e._s(t.name))])})),1)],1),a("a-form-item",{attrs:{label:"主机名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["hostName",{rules:[{required:!0,message:"请输入主机名称！"}]}],expression:"['hostName', { rules: [{ required: true, message: '请输入主机名称！' }] }]"}],attrs:{placeholder:"请输入主机名称"}})],1),a("a-form-item",{attrs:{label:"连接IP",required:""}},[a("div",{staticStyle:{display:"flex"}},[a("div",[a("a-form-item",{staticStyle:{"margin-bottom":"0px"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["rootName",{rules:[{required:!0,message:"请输入用户名！"}]}],expression:"['rootName', { rules: [{ required: true, message: '请输入用户名！' }] }]"}],staticStyle:{"max-width":"180px"},attrs:{"addon-before":"SSH:",placeholder:"用户名"}})],1)],1),a("div",[a("a-form-item",{staticStyle:{"margin-bottom":"0px"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ip",{rules:[{required:!0,message:"请输入IP地址!"}]}],expression:"['ip', { rules: [{ required: true, message: '请输入IP地址!' }] }]"}],staticStyle:{"max-width":"200px"},attrs:{"addon-before":"@",placeholder:"IP地址"}})],1)],1),a("div",[a("a-form-item",{staticStyle:{"margin-bottom":"0px"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["port",{rules:[{required:!0,message:"请输入端口!"}]}],expression:"['port', { rules: [{ required: true, message: '请输入端口!' }] }]"}],staticStyle:{"max-width":"120px"},attrs:{"addon-before":"-p",placeholder:"端口:22"}})],1)],1)])]),a("a-form-item",{attrs:{label:"配置"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["configure",{rules:[{required:!1}]}],expression:"['configure', { rules: [{ required: false}] }]"}],attrs:{placeholder:"请输入服务器配置，如：1核2G"}})],1),a("a-form-item",{attrs:{label:"备注"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remarks",{rules:[{required:!1}]}],expression:"['remarks', { rules: [{ required: false}] }]"}],attrs:{placeholder:"请输入主机备注信息"}})],1)],1)],1),a("a-modal",{attrs:{width:300,title:"请输入登录密码验证连接",visible:e.passwordVisible}},[a("a-input-password",{attrs:{placeholder:"请输入密码"},model:{value:e.host_password,callback:function(t){e.host_password=t},expression:"host_password"}}),a("a-icon",{staticStyle:{color:"#ff6400"},attrs:{type:"warning"}}),e._v(" "),a("span",{staticStyle:{color:"#ff0000","font-size":"12px"}},[e._v("注：系统不会保存您的密码")]),a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:e.pdwVisibleCancel}},[e._v(" 取 消 ")]),a("a-button",{key:"submit",attrs:{type:"primary",loading:e.sshVerifyLoading},on:{click:e.pwdVisibleHandleOk}},[e._v(" 验 证 ")])],1)],2)],1)}),[],!1,null,"d3ab9b7c",null);t.default=o.exports}}]);